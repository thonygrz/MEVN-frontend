(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["enters"],{"7e81":function(e,t,r){"use strict";r.r(t);var a=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",[r("v-data-table",{directives:[{name:"show",rawName:"v-show",value:!e.newEnter,expression:"!newEnter"}],staticClass:"elevation-1",attrs:{headers:e.headers,items:e.ingresos,search:e.search},scopedSlots:e._u([{key:"top",fn:function(){return[r("v-toolbar",{attrs:{flat:""}},[r("v-toolbar-title",[e._v("Ingresos")]),r("v-divider",{staticClass:"mx-4",attrs:{inset:"",vertical:""}}),r("v-text-field",{attrs:{"prepend-icon":"mdi-magnify",label:"Buscar","single-line":"","hide-details":"",justify:"center"},model:{value:e.search,callback:function(t){e.search=t},expression:"search"}}),r("v-spacer"),r("v-btn",{staticClass:"mb-2",attrs:{color:"primary",dark:""},on:{click:e.changeNewEnter}},[e._v(" Nuevo Item ")]),r("v-dialog",{attrs:{"max-width":"500px"},model:{value:e.dialogDelete,callback:function(t){e.dialogDelete=t},expression:"dialogDelete"}},[r("v-card",[e.actionType?r("v-card-title",{staticClass:"headline"},[e._v("¿Estás seguro de activar este item?")]):r("v-card-title",{staticClass:"headline"},[e._v("¿Estás seguro de desactivar este item?")]),r("v-card-actions",[r("v-spacer"),r("v-btn",{attrs:{color:"blue darken-1",text:""},on:{click:e.closeDelete}},[e._v("Cancelar")]),e.actionType?r("v-btn",{attrs:{color:"blue darken-1",text:""},on:{click:e.activateItemConfirm}},[e._v("Activar")]):r("v-btn",{attrs:{color:"blue darken-1",text:""},on:{click:e.deactivateItemConfirm}},[e._v("Desactivar")]),r("v-spacer")],1)],1)],1)],1)]},proxy:!0},{key:"item.actions",fn:function(t){var a=t.item;return[r("v-icon",{staticClass:"mr-2",attrs:{small:""},on:{click:function(t){return e.showItem(a)}}},[e._v(" mdi-eye ")]),1===a.status?r("v-icon",{attrs:{small:""},on:{click:function(t){return e.deactivateItem(a)}}},[e._v(" mdi-cancel ")]):r("v-icon",{attrs:{small:""},on:{click:function(t){return e.activateItem(a)}}},[e._v(" mdi-check ")])]}},{key:"no-data",fn:function(){return[r("v-btn",{attrs:{color:"primary"},on:{click:e.getIngresos}},[e._v(" Reset ")])]},proxy:!0},{key:"item.status",fn:function(t){var a=t.item;return[r("v-chip",{attrs:{color:e.getColor(a.status),dark:""}},[e._v(" "+e._s(e.statusName(a.status))+" ")])]}}])}),r("v-form",{ref:"form",attrs:{"lazy-validation":""},model:{value:e.valid,callback:function(t){e.valid=t},expression:"valid"}},[r("v-row",{directives:[{name:"show",rawName:"v-show",value:e.newEnter,expression:"newEnter"}],staticClass:"px-16 pb-16"},[r("v-col",{attrs:{cols:"12",sm:"4"}},[r("v-combobox",{attrs:{label:"Tipo de comprobante",items:e.tiposComprobante,rules:[e.rules.required]},model:{value:e.tipoComprobante,callback:function(t){e.tipoComprobante=t},expression:"tipoComprobante"}})],1),r("v-col",{attrs:{cols:"12",sm:"4"}},[r("v-text-field",{attrs:{label:"Serie de comprobante",rules:[e.rules.required,e.rules.minSeries]},model:{value:e.serieComprobante,callback:function(t){e.serieComprobante=t},expression:"serieComprobante"}})],1),r("v-col",{attrs:{cols:"12",sm:"4"}},[r("v-text-field",{attrs:{label:"Número de comprobante",rules:[e.rules.required,e.rules.minNum]},model:{value:e.numComprobante,callback:function(t){e.numComprobante=t},expression:"numComprobante"}})],1),r("v-col",{attrs:{cols:"12",sm:"8"}},[r("v-combobox",{attrs:{label:"Proveedor",items:e.proveedores,rules:[e.rules.required]},model:{value:e.proveedor,callback:function(t){e.proveedor=t},expression:"proveedor"}})],1),r("v-col",{attrs:{cols:"12",sm:"4"}},[r("v-text-field",{attrs:{label:"Impuesto",rules:[e.rules.required]},model:{value:e.impuesto,callback:function(t){e.impuesto=t},expression:"impuesto"}})],1),r("v-col",{attrs:{cols:"12",sm:"4"}},[r("v-text-field",{attrs:{label:"Código"},on:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.buscarCodigo(t)}},model:{value:e.codigo,callback:function(t){e.codigo=t},expression:"codigo"}})],1),r("v-col",{attrs:{cols:"12",sm:"1"}},[r("v-btn",{staticClass:"mx-2",attrs:{fab:"",dark:"",small:"",color:"teal"},on:{click:e.changeArticuloDialog}},[r("v-icon",{attrs:{dark:""}},[e._v(" mdi-format-list-bulleted-square ")])],1),r("v-dialog",{attrs:{"max-width":"1000px"},model:{value:e.articuloDialog,callback:function(t){e.articuloDialog=t},expression:"articuloDialog"}},[r("v-card",[r("v-card-title",[r("span",{staticClass:"headline"},[e._v(e._s(e.formTitle))])]),r("v-card-text",[r("v-container",[r("v-row",[r("v-col",{attrs:{cols:"12",sm:"12"}},[r("v-text-field",{attrs:{"prepend-icon":"mdi-magnify",label:"Buscar","single-line":"","hide-details":""},model:{value:e.searchArticulo,callback:function(t){e.searchArticulo=t},expression:"searchArticulo"}})],1),r("v-col",{attrs:{cols:"12",sm:"12"}},[r("v-data-table",{staticClass:"elevation-1",attrs:{headers:e.headers3,items:e.articulosDialog,"hide-default-footer":"",loading:e.loadDialog,"loading-text":"Buscando artículos... por favor espere."},scopedSlots:e._u([{key:"item.add",fn:function(t){var a=t.item;return[r("v-icon",{attrs:{small:""},on:{click:function(t){return e.agregarDetalle(a)}}},[e._v(" mdi-plus-thick ")])]}},{key:"item.status",fn:function(t){var a=t.item;return[r("v-chip",{attrs:{color:e.getColor(a.status),dark:""}},[e._v(" "+e._s(e.statusName(a.status))+" ")])]}}])})],1)],1)],1)],1),r("v-card-actions",[r("v-spacer"),r("v-btn",{attrs:{color:"blue darken-1",text:""},on:{click:e.close}},[e._v(" Cancelar ")])],1)],1)],1)],1),r("v-col",{attrs:{cols:"12",sm:"7"}},[r("p",{directives:[{name:"show",rawName:"v-show",value:e.errorCodeMessage,expression:"errorCodeMessage"}],staticClass:"red--text"},[e._v(" "+e._s(e.errorMessage)+" ")])]),r("v-col",{attrs:{cols:"12",sm:"12"}},[r("v-data-table",{staticClass:"elevation-1",attrs:{headers:e.headers2,items:e.articulos,"hide-default-footer":""},scopedSlots:e._u([{key:"item.actions",fn:function(t){var a=t.item;return[r("v-icon",{attrs:{small:""},on:{click:function(t){return e.removeArticle(a)}}},[e._v(" mdi-delete ")])]}},{key:"item.quantity",fn:function(t){var a=t.item;return[r("v-text-field",{attrs:{type:"number"},model:{value:a.quantity,callback:function(t){e.$set(a,"quantity",t)},expression:"item.quantity"}})]}},{key:"item.price",fn:function(t){var a=t.item;return[r("v-text-field",{attrs:{type:"number"},model:{value:a.price,callback:function(t){e.$set(a,"price",t)},expression:"item.price"}})]}},{key:"item.subtotal",fn:function(t){var a=t.item;return[r("p",[e._v("$"+e._s(a.price*a.quantity))])]}},{key:"no-data",fn:function(){return[r("v-alert",{attrs:{value:!0,color:"warning",icon:"mdi-alert"}},[e._v(" Debes añadir un artículo ")])]},proxy:!0}])})],1),r("v-col",{attrs:{cols:"12",sm:"12"}},[r("p",{staticClass:"d-flex justify-end ma-0"},[r("b",[e._v("Total Parcial $ ")]),e._v(" "+e._s(e.totalParcial)+" ")]),r("p",{staticClass:"d-flex justify-end ma-0"},[r("b",[e._v("Impuesto $ ")]),e._v(" "+e._s(e.totalImpuesto)+" ")]),r("p",{staticClass:"d-flex justify-end ma-0"},[r("b",[e._v("Impuesto $ ")]),e._v(" "+e._s(e.totalNeto)+" ")])]),r("v-col",{attrs:{cols:"12",sm:"4"}},[r("v-btn",{staticClass:"mx-2",attrs:{dark:"",small:"",color:"grey"},on:{click:e.closeNewEnter}},[e._v(" Cancelar ")]),r("v-btn",{directives:[{name:"show",rawName:"v-show",value:e.botonGuardar,expression:"botonGuardar"}],staticClass:"mx-2",attrs:{dark:"",small:"",color:"green"},on:{click:e.save}},[e._v(" Guardar ")])],1)],1)],1)],1)},o=[],n=(r("4de4"),r("4160"),r("c975"),r("d81d"),r("45fc"),r("a434"),r("b0c0"),r("b680"),r("159b"),r("96cf"),r("1da1")),s=r("bc3a"),i=r.n(s),c={name:"Enters",data:function(){return{search:"",dialog:!1,dialogDelete:!1,articuloDialog:!1,headers:[{text:"Acciones",value:"actions",sortable:!1},{text:"Usuario",value:"user.name"},{text:"Proveedor",value:"person.name"},{text:"Fecha",value:"createdAt"},{text:"Tipo de comprobante",value:"proofType"},{text:"Serie de comprobante",value:"proofSeries"},{text:"Número de comprobante",value:"proofNumber"},{text:"Impuesto",value:"tax"},{text:"Total",value:"total"},{text:"Estado",value:"status",align:"center"}],headers2:[{text:"Borrar",value:"actions",align:"center",sortable:!1},{text:"Artículo",value:"name",align:"center"},{text:"Cantidad",value:"quantity",align:"center",sortable:!1},{text:"Precio",value:"price",align:"center",sortable:!1},{text:"SubTotal",value:"subtotal",align:"center",sortable:!1}],headers3:[{text:"Agregar",value:"add",sortable:!1,align:"center"},{text:"Nombre",value:"name"},{text:"Descripción",value:"description"},{text:"Precio de venta",value:"sellingPrice"},{text:"Stock",value:"stock"},{text:"Código",value:"code"},{text:"Categoría",value:"category.name"},{text:"Estado",value:"status",align:"center"}],articulos:[],articulosDialog:[],proveedores:[],codigo:"",tiposComprobante:["FACTURA","BOLETA"],editedIndex:-1,defaultItem:{name:"",description:"",status:0},ingresos:[],_id:"",nombre:"",descripcion:"",tipoComprobante:"",serieComprobante:"",numComprobante:"",proveedor:"",rules:{required:function(e){return!!e||"Campo requerido"},min:function(e){return e&&e.length>=1&&e.length<=53||"El nombre debe estar entre 1 y 50 caracteres"},minSeries:function(e){return e&&e.length>=1&&e.length<=7||"El nombre debe estar entre 1 y 7 caracteres"},minNum:function(e){return e&&e.length>=1&&e.length<=10||"El nombre debe estar entre 1 y 10 caracteres"}},valid:!1,item:null,actionType:null,newEnter:!1,errorCodeMessage:!1,errorMessage:"error",impuesto:.18,formTitle:"Añadir artículos",searchArticulo:"",loadDialog:!1,botonGuardar:!0}},computed:{totalParcial:function(){var e=0;return this.articulos.forEach((function(t){e+=t.price*t.quantity})),e.toFixed(2)},totalImpuesto:function(){return(this.totalParcial*this.impuesto).toFixed(2)},totalNeto:function(){return(parseFloat(this.totalParcial)+parseFloat(this.totalImpuesto)).toFixed(2)}},watch:{dialog:function(e){e||this.close()},dialogDelete:function(e){e||this.closeDelete()},searchArticulo:function(){this.loadDialog=!0,this.getArticulos()}},created:function(){this.getIngresos(),this.getProveedores()},methods:{getArticulos:function(){var e=this;return Object(n["a"])(regeneratorRuntime.mark((function t(){var r,a,o;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.prev=0,r={Token:e.$store.state.token},a={headers:r},t.next=5,i.a.get("article/list?keyword="+e.searchArticulo,a);case 5:o=t.sent,e.articulosDialog=o.data,t.next=12;break;case 9:t.prev=9,t.t0=t["catch"](0),console.log(t.t0);case 12:e.loadDialog=!1;case 13:case"end":return t.stop()}}),t,null,[[0,9]])})))()},getIngresos:function(){var e=this;return Object(n["a"])(regeneratorRuntime.mark((function t(){var r,a,o;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.prev=0,r={Token:e.$store.state.token},a={headers:r},t.next=5,i.a.get("enter/list",a);case 5:o=t.sent,e.ingresos=o.data,t.next=12;break;case 9:t.prev=9,t.t0=t["catch"](0),console.log(t.t0);case 12:case"end":return t.stop()}}),t,null,[[0,9]])})))()},getProveedores:function(){var e=this;return Object(n["a"])(regeneratorRuntime.mark((function t(){var r,a,o,n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.prev=0,r={Token:e.$store.state.token},a={headers:r},t.next=5,i.a.get("person/list",a);case 5:o=t.sent,n=o.data,e.proveedores=n.filter((function(e){return"Proveedor"===e.personType})),e.proveedores=e.proveedores.map((function(e){return{value:e._id,text:e.name}})),t.next=14;break;case 11:t.prev=11,t.t0=t["catch"](0),console.log(t.t0);case 14:case"end":return t.stop()}}),t,null,[[0,11]])})))()},encontrarArticulo:function(e){var t=this.articulos.some((function(t){return t._id===e}));return console.log("find: ",t),t},removeFromArray:function(e,t){var r=e.indexOf(t);-1!=r&&e.splice(r,1)},removeArticle:function(e){this.removeFromArray(this.articulos,e)},agregarDetalle:function(e){this.encontrarArticulo(e._id)?(this.errorCodeMessage=!0,this.errorMessage="El artículo ya fue ingresado.",console.log("ya se agregó el articulo")):this.articulos.push({_id:e._id,name:e.name,quantity:1,price:e.sellingPrice})},buscarCodigo:function(){var e=this;return Object(n["a"])(regeneratorRuntime.mark((function t(){var r,a,o;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.prev=0,r={Token:e.$store.state.token},a={headers:r},t.next=5,i.a.get("article/query?code="+e.codigo,a);case 5:o=t.sent,console.log(o.data),e.errorCodeMessage=!1,e.agregarDetalle(o.data),e.codigo="",t.next=16;break;case 12:t.prev=12,t.t0=t["catch"](0),console.log(t.t0),400===t.t0.response.status&&(e.errorMessage="El código ingresado no pertenece a ningún artículo",e.errorCodeMessage=!0);case 16:case"end":return t.stop()}}),t,null,[[0,12]])})))()},statusName:function(e){return 1===e?"Activo":0===e?"Desactivado":"Estado desconocido"},showItem:function(e){this._id=e._id,this.proveedor=e.person.name,this.tipoComprobante=e.proofType,this.serieComprobante=e.proofSeries,this.numComprobante=e.proofNumber,this.impuesto=e.tax,this.articulos=e.details,this.botonGuardar=!1,this.changeNewEnter()},deactivateItem:function(e){this._id=e._id,this.actionType=0,this.dialogDelete=!0},activateItem:function(e){this._id=e._id,this.actionType=1,this.dialogDelete=!0},deactivateItemConfirm:function(){var e=this;return Object(n["a"])(regeneratorRuntime.mark((function t(){var r,a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.prev=0,r={Token:e.$store.state.token},a={headers:r},t.next=5,i.a.put("/enter/deactivate",{_id:e._id},a);case 5:e.clean(),e.close(),e.getIngresos(),t.next=13;break;case 10:t.prev=10,t.t0=t["catch"](0),console.log(t.t0);case 13:e.closeDelete();case 14:case"end":return t.stop()}}),t,null,[[0,10]])})))()},activateItemConfirm:function(){var e=this;return Object(n["a"])(regeneratorRuntime.mark((function t(){var r,a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.prev=0,r={Token:e.$store.state.token},a={headers:r},t.next=5,i.a.put("/enter/activate",{_id:e._id},a);case 5:e.clean(),e.close(),e.getIngresos(),t.next=13;break;case 10:t.prev=10,t.t0=t["catch"](0),console.log(t.t0);case 13:e.closeDelete();case 14:case"end":return t.stop()}}),t,null,[[0,10]])})))()},close:function(){this.articuloDialog=!1,this.searchArticulo="",this.$refs.form.resetValidation()},closeDelete:function(){var e=this;this.dialogDelete=!1,this.$nextTick((function(){e.editedItem=Object.assign({},e.defaultItem),e.editedIndex=-1}))},clean:function(){this._id="",this.nombre="",this.descripcion="",this.proveedor="",this.tipoComprobante="",this.serieComprobante="",this.numComprobante="",this.articulos=[],this.$refs.form.resetValidation()},getColor:function(e){return 1===e?"green":0===e?"red":"black"},closeNewEnter:function(){this.clean(),this.changeNewEnter(),this.botonGuardar=!0},changeNewEnter:function(){this.newEnter=!this.newEnter},changeArticuloDialog:function(){this.articuloDialog=!this.articuloDialog},save:function(){var e=this;return Object(n["a"])(regeneratorRuntime.mark((function t(){var r,a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(!(e.$refs.form.validate()&&e.articulos.length>0)){t.next=16;break}return t.prev=1,r={Token:e.$store.state.token},a={headers:r},t.next=6,i.a.post("/enter/add",{user:e.$store.state.user._id,person:e.proveedor.value,proofType:e.tipoComprobante,proofSeries:e.serieComprobante,proofNumber:e.numComprobante,tax:e.impuesto,total:e.totalNeto,details:e.articulos},a);case 6:e.clean(),e.changeNewEnter(),e.getArticulos(),e.getIngresos(),t.next=15;break;case 12:t.prev=12,t.t0=t["catch"](1),console.log(t.t0);case 15:e.close();case 16:case"end":return t.stop()}}),t,null,[[1,12]])})))()}}},l=c,u=r("2877"),d=r("6544"),v=r.n(d),m=r("0798"),p=r("8336"),f=r("b0af"),h=r("99d9"),g=r("cc20"),b=r("62ad"),x=r("2b5d"),k=r("a523"),C=r("8fea"),w=r("169a"),_=r("ce7e"),y=r("4bd4"),D=r("132d"),T=r("0fd9"),I=r("2fa4"),A=r("8654"),E=r("71d9"),N=r("2a7f"),V=Object(u["a"])(l,a,o,!1,null,null,null);t["default"]=V.exports;v()(V,{VAlert:m["a"],VBtn:p["a"],VCard:f["a"],VCardActions:h["a"],VCardText:h["b"],VCardTitle:h["c"],VChip:g["a"],VCol:b["a"],VCombobox:x["a"],VContainer:k["a"],VDataTable:C["a"],VDialog:w["a"],VDivider:_["a"],VForm:y["a"],VIcon:D["a"],VRow:T["a"],VSpacer:I["a"],VTextField:A["a"],VToolbar:E["a"],VToolbarTitle:N["a"]})}}]);
//# sourceMappingURL=enters.94caf360.js.map